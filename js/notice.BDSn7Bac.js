import{at as e,ad as l,ae as t,c as a,e as i,a4 as s,w as o,Q as d,ah as r,l as m,a3 as u,k as n,t as p,ac as c,O as h,ap as _,P as f,aB as g,au as y}from"./index.fjkLwUVu.js";import{v as b}from"./el-loading.DGjIZa5s.js";import{a as V,E as v}from"./el-tab-pane.BAi5YHW8.js";import{_ as k}from"./index.CsSweb41.js";import"./el-scrollbar.DAmtYv6U.js";import{E as j}from"./el-color-picker.D-6QTkDl.js";import{_ as q}from"./index.uvQ3DMPv.js";import{E as w,a as x}from"./el-table-column.CcJDJdsG.js";import"./el-checkbox.Bx2MqeyX.js";import"./el-tooltip.l0sNRNKZ.js";import"./el-popper.DZg10sPd.js";import{E as U}from"./el-link.Ds1J_vSa.js";import{_ as D}from"./FileImage.CNK6_fwR.js";import{a as C,E as Y}from"./el-select.Dphl92Bb.js";import{E as T}from"./el-dialog.BQ-7T3N1.js";import{E,a as I}from"./el-form-item.LUBrM-X2.js";import{E as S}from"./el-switch.CZooYmGS.js";import{E as H}from"./el-row.CR2lAonX.js";import{E as M}from"./el-col.Asb1dzXh.js";import{E as A}from"./el-date-picker.CuOHw7o_.js";import{s as $}from"./screen-height.CaLnsKT6.js";import{a as O}from"./index.DKis4amu.js";import{g as G}from"./settings.BkEO_yzR.js";import{_ as P}from"./_plugin-vue_export-helper.BCo6x5W8.js";import{E as z}from"./index.CC5uJ0zJ.js";import"./strings.BFjoWW54.js";import"./index.CZvH84Pk.js";import"./FilePreview.ysv9CpFr.js";import"./el-image-viewer.CKIWDlAT.js";import"./index.BAnbBVvD.js";import"./index.Ca7HhsrZ.js";/* empty css                          */import"./el-progress.C11kH2od.js";import"./cloneDeep.CpzyAp_h.js";import"./isEqual.C9MgJhLZ.js";import"./_Uint8Array.BeplMWlC.js";import"./el-card.DQc9Ri4s.js";import"./el-text.BpgAV3tu.js";/* empty css                       */import"./permission.6opTfbBv.js";import"./group.Dp74GP4K.js";import"./tag.C6qLWou5.js";import"./index.D1QADgj8.js";import"./index.BIv6f7sb.js";import"./raf.CCooGNZO.js";import"./el-avatar.CztSEU-_.js";import"./castArray.BF9loTbA.js";import"./refs.A9PVpu8F.js";import"./tagsView.DWSC-EGY.js";const F="/admin/setting.Notice/";const R={class:"app-container"},N={class:"c-red"};const B=P({name:"SettingNotice",components:{Pagination:q,RichEditor:k},data:()=>({name:"通告",height:680,loading:!1,idkey:"notice_id",exps:[{exp:"like",name:"包含"}],query:{page:1,limit:G(),search_field:"title",search_exp:"like",date_field:"create_time"},data:[],count:0,dialog:!1,dialogTitle:"",model:{notice_id:"",image_id:0,image_url:"",type:0,title:"",title_color:"",start_time:"",end_time:"",desc:"",content:"",remark:"",sort:250},rules:{title:[{required:!0,message:"请输入标题",trigger:"blur"}],start_time:[{required:!0,message:"请输入开始时间",trigger:"blur"}],end_time:[{required:!0,message:"请输入结束时间",trigger:"blur"}]},types:[],selection:[],selectIds:"",selectTitle:"操作",selectDialog:!1,selectType:"",type:0,start_time:"",end_time:"",is_disable:0}),created(){this.height=$(),this.list()},methods:{list(){var l;this.loading=!0,(l=this.query,e({url:F+"list",method:"get",params:l})).then((e=>{this.data=e.data.list,this.count=e.data.count,this.types=e.data.types,this.exps=e.data.exps,this.loading=!1})).catch((()=>{this.loading=!1}))},add(){this.dialog=!0,this.dialogTitle=this.name+"添加",this.reset()},edit(l){this.dialog=!0,this.dialogTitle=this.name+"修改："+l[this.idkey];var t,a={};a[this.idkey]=l[this.idkey],(t=a,e({url:F+"info",method:"get",params:t})).then((e=>{this.reset(e.data)})).catch((()=>{}))},cancel(){this.dialog=!1,this.reset()},submit(){this.$refs.ref.validate((t=>{var a;t?(this.loading=!0,this.model[this.idkey]?(a=this.model,e({url:F+"edit",method:"post",data:a})).then((e=>{this.list(),this.dialog=!1,l.success(e.msg)})).catch((()=>{this.loading=!1})):function(l){return e({url:F+"add",method:"post",data:l})}(this.model).then((e=>{this.list(),this.dialog=!1,l.success(e.msg)})).catch((()=>{this.loading=!1}))):l.error("请完善必填项（带红色星号*）")}))},reset(e){if(this.model=e||this.$options.data().model,void 0!==this.$refs.ref)try{this.$refs.ref.resetFields(),this.$refs.ref.clearValidate()}catch(l){}},search(){this.query.page=1,this.list()},refresh(){const e=this.query.limit;this.query=this.$options.data().query,this.$refs.table.clearSort(),this.query.limit=e,this.list()},sort(e){this.query.sort_field=e.prop,this.query.sort_value="","ascending"===e.order&&(this.query.sort_value="asc",this.list()),"descending"===e.order&&(this.query.sort_value="desc",this.list())},select(e){this.selection=e,this.selectIds=this.selectGetIds(e).toString()},selectGetIds(e){return O(e,this.idkey)},selectAlert(){t.alert("请选择需要操作的"+this.name,"提示",{type:"warning",callback:()=>{}})},selectOpen(e,l=""){if(l){this.$refs.table.clearSelection();const e=l.length;for(let t=0;t<e;t++)this.$refs.table.toggleRowSelection(l[t],!0)}this.selection.length?(this.selectTitle="操作","edittype"===e?this.selectTitle=this.name+"修改类型":"datetime"===e?this.selectTitle=this.name+"时间范围":"disable"===e?this.selectTitle=this.name+"是否禁用":"dele"===e&&(this.selectTitle=this.name+"删除"),this.selectDialog=!0,this.selectType=e):this.selectAlert()},selectCancel(){this.selectDialog=!1},selectSubmit(){if(this.selection.length){const e=this.selectType;"edittype"===e?this.edittype(this.selection):"datetime"===e?this.datetime(this.selection):"disable"===e?this.disable(this.selection,!0):"dele"===e&&this.dele(this.selection),this.selectDialog=!1}else this.selectAlert()},edittype(t){var a;t.length?(this.loading=!0,(a={ids:this.selectGetIds(t),type:this.type},e({url:F+"edittype",method:"post",data:a})).then((e=>{this.list(),l.success(e.msg)})).catch((()=>{this.loading=!1}))):this.selectAlert()},datetime(t){var a;t.length?(this.loading=!0,(a={ids:this.selectGetIds(t),start_time:this.start_time,end_time:this.end_time},e({url:F+"datetime",method:"post",data:a})).then((e=>{this.list(),l.success(e.msg)})).catch((()=>{this.loading=!1}))):this.selectAlert()},disable(t,a=!1){if(t.length){this.loading=!0;var i=t[0].is_disable;a&&(i=this.is_disable),(s={ids:this.selectGetIds(t),is_disable:i},e({url:F+"disable",method:"post",data:s})).then((e=>{this.list(),l.success(e.msg)})).catch((()=>{this.list()}))}else this.selectAlert();var s},dele(t){var a;t.length?(a={ids:this.selectGetIds(t)},e({url:F+"dele",method:"post",data:a})).then((e=>{this.list(),l.success(e.msg)})).catch((()=>{this.loading=!1})):this.selectAlert()}}},[["render",function(e,l,t,$,O,G){const P=C,F=Y,B=g,Q=A,J=y,K=M,L=H,W=E,X=S,Z=I,ee=T,le=w,te=D,ae=U,ie=x,se=q,oe=j,de=z,re=V,me=k,ue=v,ne=b;return a(),i("div",R,[s(L,null,{default:o((()=>[s(K,{class:"mb-2"},{default:o((()=>[s(F,{modelValue:O.query.search_field,"onUpdate:modelValue":l[0]||(l[0]=e=>O.query.search_field=e),class:"ya-search-field",placeholder:"查询字段"},{default:o((()=>[s(P,{value:O.idkey,label:"ID"},null,8,["value"]),s(P,{value:"type",label:"类型"}),s(P,{value:"title",label:"标题"}),s(P,{value:"desc",label:"描述"}),s(P,{value:"remark",label:"备注"}),s(P,{value:"is_disable",label:"禁用"})])),_:1},8,["modelValue"]),s(F,{modelValue:O.query.search_exp,"onUpdate:modelValue":l[1]||(l[1]=e=>O.query.search_exp=e),class:"ya-search-exp"},{default:o((()=>[(a(!0),i(d,null,r(O.exps,(e=>(a(),m(P,{key:e.exp,value:e.exp,label:e.name},null,8,["value","label"])))),128))])),_:1},8,["modelValue"]),"is_disable"===O.query.search_field?(a(),m(F,{key:0,modelValue:O.query.search_value,"onUpdate:modelValue":l[2]||(l[2]=e=>O.query.search_value=e),class:"ya-search-value"},{default:o((()=>[s(P,{value:1,label:"是"}),s(P,{value:0,label:"否"})])),_:1},8,["modelValue"])):"type"===O.query.search_field?(a(),m(F,{key:1,modelValue:O.query.search_value,"onUpdate:modelValue":l[3]||(l[3]=e=>O.query.search_value=e),class:"ya-search-value"},{default:o((()=>[(a(!0),i(d,null,r(O.types,((e,l)=>(a(),m(P,{key:l,value:l,label:e},null,8,["value","label"])))),128))])),_:1},8,["modelValue"])):(a(),m(B,{key:2,modelValue:O.query.search_value,"onUpdate:modelValue":l[4]||(l[4]=e=>O.query.search_value=e),class:"ya-search-value",placeholder:"查询内容",clearable:""},null,8,["modelValue"])),s(F,{modelValue:O.query.date_field,"onUpdate:modelValue":l[5]||(l[5]=e=>O.query.date_field=e),class:"ya-date-field",placeholder:"时间字段"},{default:o((()=>[s(P,{value:"create_time",label:"添加时间"}),s(P,{value:"update_time",label:"修改时间"}),s(P,{value:"start_time",label:"开始时间"}),s(P,{value:"end_time",label:"结束时间"})])),_:1},8,["modelValue"]),s(Q,{modelValue:O.query.date_value,"onUpdate:modelValue":l[6]||(l[6]=e=>O.query.date_value=e),type:"datetimerange",class:"ya-date-value","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"YYYY-MM-DD HH:mm:ss","default-time":[new Date(2024,1,1,0,0,0),new Date(2024,1,1,23,59,59)]},null,8,["modelValue","default-time"]),s(J,{type:"primary",title:"查询/刷新",onClick:l[7]||(l[7]=e=>G.search())},{default:o((()=>l[37]||(l[37]=[u("查询")]))),_:1}),s(J,{type:"default",title:"重置查询条件",onClick:l[8]||(l[8]=e=>G.refresh())},{default:o((()=>l[38]||(l[38]=[u("重置")]))),_:1}),s(J,{type:"primary",onClick:l[9]||(l[9]=e=>G.add())},{default:o((()=>l[39]||(l[39]=[u("添加")]))),_:1})])),_:1})])),_:1}),s(L,null,{default:o((()=>[s(K,null,{default:o((()=>[s(J,{title:"删除",onClick:l[10]||(l[10]=e=>G.selectOpen("dele"))},{default:o((()=>l[40]||(l[40]=[u("删除")]))),_:1}),s(J,{title:"是否禁用",onClick:l[11]||(l[11]=e=>G.selectOpen("disable"))},{default:o((()=>l[41]||(l[41]=[u("禁用")]))),_:1}),s(J,{title:"修改类型",onClick:l[12]||(l[12]=e=>G.selectOpen("edittype"))},{default:o((()=>l[42]||(l[42]=[u("类型")]))),_:1}),s(J,{title:"时间范围",onClick:l[13]||(l[13]=e=>G.selectOpen("datetime"))},{default:o((()=>l[43]||(l[43]=[u("时间")]))),_:1})])),_:1})])),_:1}),s(ee,{modelValue:O.selectDialog,"onUpdate:modelValue":l[19]||(l[19]=e=>O.selectDialog=e),title:O.selectTitle,"close-on-click-modal":!1,"close-on-press-escape":!1,top:"20vh"},{footer:o((()=>[s(J,{loading:O.loading,onClick:G.selectCancel},{default:o((()=>l[45]||(l[45]=[u("取消")]))),_:1},8,["loading","onClick"]),s(J,{loading:O.loading,type:"primary",onClick:G.selectSubmit},{default:o((()=>l[46]||(l[46]=[u("提交")]))),_:1},8,["loading","onClick"])])),default:o((()=>[s(Z,{ref:"selectRef","label-width":"120px"},{default:o((()=>["edittype"===O.selectType?(a(),m(W,{key:0,label:"类型"},{default:o((()=>[s(F,{modelValue:O.type,"onUpdate:modelValue":l[14]||(l[14]=e=>O.type=e)},{default:o((()=>[(a(!0),i(d,null,r(O.types,((e,l)=>(a(),m(P,{key:l,value:l,label:e},null,8,["value","label"])))),128))])),_:1},8,["modelValue"])])),_:1})):"datetime"===O.selectType?(a(),m(W,{key:1,label:"时间范围"},{default:o((()=>[s(Q,{modelValue:O.start_time,"onUpdate:modelValue":l[15]||(l[15]=e=>O.start_time=e),type:"datetime","value-format":"YYYY-MM-DD HH:mm:ss","default-time":new Date(2024,1,1,0,0,0),placeholder:"开始时间"},null,8,["modelValue","default-time"]),l[44]||(l[44]=n("span",null,"至",-1)),s(Q,{modelValue:O.end_time,"onUpdate:modelValue":l[16]||(l[16]=e=>O.end_time=e),type:"datetime","value-format":"YYYY-MM-DD HH:mm:ss","default-time":new Date(2024,1,1,23,59,59),placeholder:"结束时间"},null,8,["modelValue","default-time"])])),_:1})):"disable"===O.selectType?(a(),m(W,{key:2,label:"是否禁用"},{default:o((()=>[s(X,{modelValue:O.is_disable,"onUpdate:modelValue":l[17]||(l[17]=e=>O.is_disable=e),"active-value":1,"inactive-value":0},null,8,["modelValue"])])),_:1})):"dele"===O.selectType?(a(),m(W,{key:3},{default:o((()=>[n("span",N,"确定要删除选中的"+p(O.name)+"吗？",1)])),_:1})):c("",!0),s(W,{label:O.name+"ID"},{default:o((()=>[s(B,{modelValue:O.selectIds,"onUpdate:modelValue":l[18]||(l[18]=e=>O.selectIds=e),type:"textarea",autosize:"",disabled:""},null,8,["modelValue"])])),_:1},8,["label"])])),_:1},512)])),_:1},8,["modelValue","title"]),h((a(),m(ie,{ref:"table",data:O.data,height:O.height,onSortChange:G.sort,onSelectionChange:G.select},{default:o((()=>[s(le,{type:"selection",width:"42",title:"全选/反选"}),s(le,{prop:O.idkey,label:"ID",width:"80",sortable:"custom"},null,8,["prop"]),s(le,{prop:"image_id",label:"图片","min-width":"62"},{default:o((e=>[s(te,{"file-url":e.row.image_url,lazy:""},null,8,["file-url"])])),_:1}),s(le,{prop:"type_name",label:"类型","min-width":"85"}),s(le,{prop:"title",label:"标题","min-width":"220","show-overflow-tooltip":""},{default:o((e=>[n("span",{style:_({color:e.row.title_color})},p(e.row.title),5)])),_:1}),s(le,{prop:"start_time",label:"开始时间",width:"165",sortable:"custom"}),s(le,{prop:"end_time",label:"结束时间",width:"165",sortable:"custom"}),s(le,{prop:"is_disable_name",label:"禁用","min-width":"80",sortable:"custom"}),s(le,{prop:"sort",label:"排序","min-width":"80",sortable:"custom"}),s(le,{prop:"create_time",label:"添加时间",width:"165",sortable:"custom"}),s(le,{prop:"update_time",label:"修改时间",width:"165",sortable:"custom"}),s(le,{label:"操作",width:"95"},{default:o((e=>[s(ae,{type:"primary",class:"mr-1",underline:!1,onClick:l=>G.edit(e.row)},{default:o((()=>l[47]||(l[47]=[u(" 修改 ")]))),_:2},1032,["onClick"]),s(ae,{type:"primary",underline:!1,onClick:l=>G.selectOpen("dele",[e.row])},{default:o((()=>l[48]||(l[48]=[u(" 删除 ")]))),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data","height","onSortChange","onSelectionChange"])),[[ne,O.loading]]),h(s(se,{total:O.count,"onUpdate:total":l[20]||(l[20]=e=>O.count=e),page:O.query.page,"onUpdate:page":l[21]||(l[21]=e=>O.query.page=e),limit:O.query.limit,"onUpdate:limit":l[22]||(l[22]=e=>O.query.limit=e),onPagination:G.list},null,8,["total","page","limit","onPagination"]),[[f,O.count>0]]),s(ee,{modelValue:O.dialog,"onUpdate:modelValue":l[36]||(l[36]=e=>O.dialog=e),title:O.dialogTitle,"close-on-click-modal":!1,"close-on-press-escape":!1,"before-close":G.cancel,top:"5vh"},{footer:o((()=>[s(J,{loading:O.loading,onClick:G.cancel},{default:o((()=>l[50]||(l[50]=[u("取消")]))),_:1},8,["loading","onClick"]),s(J,{loading:O.loading,type:"primary",onClick:G.submit},{default:o((()=>l[51]||(l[51]=[u("提交")]))),_:1},8,["loading","onClick"])])),default:o((()=>[s(Z,{ref:"ref",model:O.model,rules:O.rules,"label-width":"100px"},{default:o((()=>[s(ue,null,{default:o((()=>[s(re,{label:"信息"},{default:o((()=>[s(de,{native:"",height:O.height-80},{default:o((()=>[s(W,{label:"图片",prop:"image_id"},{default:o((()=>[s(te,{modelValue:O.model.image_id,"onUpdate:modelValue":l[23]||(l[23]=e=>O.model.image_id=e),"file-url":O.model.image_url,height:100,upload:""},null,8,["modelValue","file-url"])])),_:1}),s(W,{label:"类型",prop:"type"},{default:o((()=>[s(F,{modelValue:O.model.type,"onUpdate:modelValue":l[24]||(l[24]=e=>O.model.type=e)},{default:o((()=>[(a(!0),i(d,null,r(O.types,((e,l)=>(a(),m(P,{key:l,value:l,label:e},null,8,["value","label"])))),128))])),_:1},8,["modelValue"])])),_:1}),s(W,{label:"标题",prop:"title"},{default:o((()=>[s(K,{span:18},{default:o((()=>[s(B,{modelValue:O.model.title,"onUpdate:modelValue":l[25]||(l[25]=e=>O.model.title=e),placeholder:"请输入标题",clearable:""},null,8,["modelValue"])])),_:1}),s(K,{span:3,class:"text-center"},{default:o((()=>l[49]||(l[49]=[u("标题颜色")]))),_:1}),s(K,{span:3},{default:o((()=>[s(oe,{modelValue:O.model.title_color,"onUpdate:modelValue":l[26]||(l[26]=e=>O.model.title_color=e)},null,8,["modelValue"])])),_:1})])),_:1}),s(W,{label:"描述",prop:"desc"},{default:o((()=>[s(B,{modelValue:O.model.desc,"onUpdate:modelValue":l[27]||(l[27]=e=>O.model.desc=e),type:"textarea",autosize:"",placeholder:"请输入描述"},null,8,["modelValue"])])),_:1}),s(W,{label:"开始时间",prop:"start_time"},{default:o((()=>[s(Q,{modelValue:O.model.start_time,"onUpdate:modelValue":l[28]||(l[28]=e=>O.model.start_time=e),type:"datetime","value-format":"YYYY-MM-DD HH:mm:ss",placeholder:"开始时间","default-time":new Date(2024,1,1,0,0,0)},null,8,["modelValue","default-time"])])),_:1}),s(W,{label:"结束时间",prop:"end_time"},{default:o((()=>[s(Q,{modelValue:O.model.end_time,"onUpdate:modelValue":l[29]||(l[29]=e=>O.model.end_time=e),type:"datetime","value-format":"YYYY-MM-DD HH:mm:ss",placeholder:"结束时间","default-time":new Date(2024,1,1,23,59,59)},null,8,["modelValue","default-time"])])),_:1}),s(W,{label:"备注",prop:"remark"},{default:o((()=>[s(B,{modelValue:O.model.remark,"onUpdate:modelValue":l[30]||(l[30]=e=>O.model.remark=e),placeholder:"请输入备注",clearable:""},null,8,["modelValue"])])),_:1}),s(W,{label:"排序",prop:"sort"},{default:o((()=>[s(B,{modelValue:O.model.sort,"onUpdate:modelValue":l[31]||(l[31]=e=>O.model.sort=e),type:"number",placeholder:"请输入排序"},null,8,["modelValue"])])),_:1}),O.model[O.idkey]?(a(),m(W,{key:0,label:"添加时间",prop:"create_time"},{default:o((()=>[s(B,{modelValue:O.model.create_time,"onUpdate:modelValue":l[32]||(l[32]=e=>O.model.create_time=e),disabled:""},null,8,["modelValue"])])),_:1})):c("",!0),O.model[O.idkey]?(a(),m(W,{key:1,label:"修改时间",prop:"update_time"},{default:o((()=>[s(B,{modelValue:O.model.update_time,"onUpdate:modelValue":l[33]||(l[33]=e=>O.model.update_time=e),disabled:""},null,8,["modelValue"])])),_:1})):c("",!0),O.model.delete_time?(a(),m(W,{key:2,label:"删除时间",prop:"delete_time"},{default:o((()=>[s(B,{modelValue:O.model.delete_time,"onUpdate:modelValue":l[34]||(l[34]=e=>O.model.delete_time=e),disabled:""},null,8,["modelValue"])])),_:1})):c("",!0)])),_:1},8,["height"])])),_:1}),s(re,{label:"内容"},{default:o((()=>[s(de,{native:"",height:O.height-80},{default:o((()=>[s(W,{label:"内容",prop:"content"},{default:o((()=>[s(me,{modelValue:O.model.content,"onUpdate:modelValue":l[35]||(l[35]=e=>O.model.content=e)},null,8,["modelValue"])])),_:1})])),_:1},8,["height"])])),_:1})])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title","before-close"])])}]]);export{B as default};
