import{at as e,ad as l,ae as a,c as t,e as i,a4 as o,w as d,Q as s,ah as r,l as m,a3 as u,k as n,t as p,ac as c,O as h,P as f,aB as _,au as b}from"./index.fjkLwUVu.js";import{v as g}from"./el-loading.DGjIZa5s.js";import"./el-scrollbar.DAmtYv6U.js";import{_ as y}from"./index.uvQ3DMPv.js";import{E as V,a as v}from"./el-table-column.CcJDJdsG.js";import"./el-checkbox.Bx2MqeyX.js";import"./el-tooltip.l0sNRNKZ.js";import"./el-popper.DZg10sPd.js";import{E as k}from"./el-link.Ds1J_vSa.js";import{_ as j}from"./FileImage.CNK6_fwR.js";import{a as w,E as q}from"./el-select.Dphl92Bb.js";import{E as U}from"./el-dialog.BQ-7T3N1.js";import{E as x,a as C}from"./el-form-item.LUBrM-X2.js";import{E as D}from"./el-switch.CZooYmGS.js";import{E as I}from"./el-row.CR2lAonX.js";import{E as T}from"./el-col.Asb1dzXh.js";import{E}from"./el-date-picker.CuOHw7o_.js";import{s as S}from"./screen-height.CaLnsKT6.js";import{a as $}from"./index.DKis4amu.js";import{g as A}from"./settings.BkEO_yzR.js";import{_ as P}from"./_plugin-vue_export-helper.BCo6x5W8.js";import{E as O}from"./index.CC5uJ0zJ.js";import"./isEqual.C9MgJhLZ.js";import"./_Uint8Array.BeplMWlC.js";import"./strings.BFjoWW54.js";import"./index.BIv6f7sb.js";import"./raf.CCooGNZO.js";import"./index.BAnbBVvD.js";import"./el-text.BpgAV3tu.js";import"./el-avatar.CztSEU-_.js";import"./el-image-viewer.CKIWDlAT.js";import"./index.Ca7HhsrZ.js";import"./index.CZvH84Pk.js";import"./FilePreview.ysv9CpFr.js";/* empty css                          */import"./el-progress.C11kH2od.js";import"./cloneDeep.CpzyAp_h.js";import"./el-card.DQc9Ri4s.js";/* empty css                       */import"./permission.6opTfbBv.js";import"./group.Dp74GP4K.js";import"./tag.C6qLWou5.js";import"./index.D1QADgj8.js";import"./castArray.BF9loTbA.js";import"./refs.A9PVpu8F.js";import"./tagsView.DWSC-EGY.js";const G="/admin/member.Third/";const Y={class:"app-container"},F={class:"c-red"};const M=P({name:"MemberThird",components:{Pagination:y},data:()=>({name:"会员第三方账号",height:680,loading:!1,idkey:"third_id",exps:[{exp:"like",name:"包含"}],query:{page:1,limit:A(),search_field:"nickname",search_exp:"like",date_field:"create_time"},data:[],count:0,platforms:[],applications:[],dialog:!1,dialogTitle:"",model:{third_id:"",member_id:0,platform:20,application:21,unionid:"",openid:"",headimgurl:"",nickname:"",remark:""},rules:{member_id:[{required:!0,message:"请输入openid",trigger:"blur"}],openid:[{required:!0,message:"请输入openid",trigger:"blur"}]},selection:[],selectIds:"",selectTitle:"操作",selectDialog:!1,selectType:"",is_disable:0}),created(){this.height=S(),this.list()},methods:{list(){var l;this.loading=!0,(l=this.query,e({url:G+"list",method:"get",params:l})).then((e=>{this.data=e.data.list,this.count=e.data.count,this.exps=e.data.exps,this.platforms=e.data.platforms,this.applications=e.data.applications,this.loading=!1})).catch((()=>{this.loading=!1}))},add(){this.dialog=!0,this.dialogTitle=this.name+"添加",this.reset()},edit(l){this.dialog=!0,this.dialogTitle=this.name+"修改："+l[this.idkey];var a,t={};t[this.idkey]=l[this.idkey],(a=t,e({url:G+"info",method:"get",params:a})).then((e=>{this.reset(e.data)})).catch((()=>{}))},cancel(){this.dialog=!1,this.reset()},submit(){this.$refs.ref.validate((a=>{var t;a&&(this.loading=!0,this.model[this.idkey]?(t=this.model,e({url:G+"edit",method:"post",data:t})).then((e=>{this.list(),this.dialog=!1,l.success(e.msg)})).catch((()=>{this.loading=!1})):function(l){return e({url:G+"add",method:"post",data:l})}(this.model).then((e=>{this.list(),this.dialog=!1,l.success(e.msg)})).catch((()=>{this.loading=!1})))}))},reset(e){if(this.model=e||this.$options.data().model,void 0!==this.$refs.ref)try{this.$refs.ref.resetFields(),this.$refs.ref.clearValidate()}catch(l){}},search(){this.query.page=1,this.list()},refresh(){const e=this.query.limit;this.query=this.$options.data().query,this.$refs.table.clearSort(),this.query.limit=e,this.list()},sort(e){this.query.sort_field=e.prop,this.query.sort_value="","ascending"===e.order&&(this.query.sort_value="asc",this.list()),"descending"===e.order&&(this.query.sort_value="desc",this.list())},select(e){this.selection=e,this.selectIds=this.selectGetIds(e).toString()},selectGetIds(e){return $(e,this.idkey)},selectAlert(){a.alert("请选择需要操作的"+this.name,"提示",{type:"warning",callback:()=>{}})},selectOpen(e,l=""){if(l){this.$refs.table.clearSelection();const e=l.length;for(let a=0;a<e;a++)this.$refs.table.toggleRowSelection(l[a],!0)}this.selection.length?(this.selectTitle="操作","disable"===e?this.selectTitle=this.name+"是否禁用":"dele"===e&&(this.selectTitle=this.name+"删除"),this.selectDialog=!0,this.selectType=e):this.selectAlert()},selectCancel(){this.selectDialog=!1},selectSubmit(){if(this.selection.length){const e=this.selectType;"disable"===e?this.disable(this.selection,!0):"dele"===e&&this.dele(this.selection,!0),this.selectDialog=!1}else this.selectAlert()},disable(a,t=!1){if(a.length){this.loading=!0;var i=a[0].is_disable;t&&(i=this.is_disable),(o={ids:this.selectGetIds(a),is_disable:i},e({url:G+"disable",method:"post",data:o})).then((e=>{this.list(),l.success(e.msg)})).catch((()=>{this.list()}))}else this.selectAlert();var o},dele(a){var t;a.length?(this.loading=!0,(t={ids:this.selectGetIds(a)},e({url:G+"dele",method:"post",data:t})).then((e=>{this.list(),l.success(e.msg)})).catch((()=>{this.loading=!1}))):this.selectAlert()}}},[["render",function(e,l,a,S,$,A){const P=w,G=q,M=_,z=E,H=b,R=T,B=I,Q=D,J=x,K=C,L=U,N=V,W=j,X=k,Z=v,ee=y,le=O,ae=g;return t(),i("div",Y,[o(B,null,{default:d((()=>[o(R,{class:"mb-2"},{default:d((()=>[o(G,{modelValue:$.query.search_field,"onUpdate:modelValue":l[0]||(l[0]=e=>$.query.search_field=e),class:"ya-search-field",placeholder:"查询字段"},{default:d((()=>[o(P,{value:$.idkey,label:"ID"},null,8,["value"]),o(P,{value:"member_id",label:"会员ID"}),o(P,{value:"nickname",label:"昵称"}),o(P,{value:"platform",label:"平台"}),o(P,{value:"application",label:"应用"}),o(P,{value:"remark",label:"备注"}),o(P,{value:"is_disable",label:"禁用"}),o(P,{value:"unionid",label:"unionid"}),o(P,{value:"openid",label:"openid"})])),_:1},8,["modelValue"]),o(G,{modelValue:$.query.search_exp,"onUpdate:modelValue":l[1]||(l[1]=e=>$.query.search_exp=e),class:"ya-search-exp"},{default:d((()=>[(t(!0),i(s,null,r($.exps,(e=>(t(),m(P,{key:e.exp,value:e.exp,label:e.name},null,8,["value","label"])))),128))])),_:1},8,["modelValue"]),"is_disable"===$.query.search_field?(t(),m(G,{key:0,modelValue:$.query.search_value,"onUpdate:modelValue":l[2]||(l[2]=e=>$.query.search_value=e),class:"ya-search-value"},{default:d((()=>[o(P,{value:1,label:"是"}),o(P,{value:0,label:"否"})])),_:1},8,["modelValue"])):"platform"===$.query.search_field?(t(),m(G,{key:1,modelValue:$.query.search_value,"onUpdate:modelValue":l[3]||(l[3]=e=>$.query.search_value=e),class:"ya-search-value"},{default:d((()=>[(t(!0),i(s,null,r($.platforms,(e=>(t(),m(P,{key:e.value,value:e.value,label:e.label},null,8,["value","label"])))),128))])),_:1},8,["modelValue"])):"application"===$.query.search_field?(t(),m(G,{key:2,modelValue:$.query.search_value,"onUpdate:modelValue":l[4]||(l[4]=e=>$.query.search_value=e),class:"ya-search-value"},{default:d((()=>[(t(!0),i(s,null,r($.applications,(e=>(t(),m(P,{key:e.value,value:e.value,label:e.label},null,8,["value","label"])))),128))])),_:1},8,["modelValue"])):(t(),m(M,{key:3,modelValue:$.query.search_value,"onUpdate:modelValue":l[5]||(l[5]=e=>$.query.search_value=e),class:"ya-search-value",placeholder:"查询内容",clearable:""},null,8,["modelValue"])),o(G,{modelValue:$.query.date_field,"onUpdate:modelValue":l[6]||(l[6]=e=>$.query.date_field=e),class:"ya-date-field",placeholder:"时间类型"},{default:d((()=>[o(P,{value:"create_time",label:"添加时间"}),o(P,{value:"update_time",label:"修改时间"}),o(P,{value:"login_time",label:"登录时间"})])),_:1},8,["modelValue"]),o(z,{modelValue:$.query.date_value,"onUpdate:modelValue":l[7]||(l[7]=e=>$.query.date_value=e),type:"datetimerange",class:"ya-date-value","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"YYYY-MM-DD HH:mm:ss","default-time":[new Date(2024,1,1,0,0,0),new Date(2024,1,1,23,59,59)]},null,8,["modelValue","default-time"]),o(H,{type:"primary",title:"查询/刷新",onClick:l[8]||(l[8]=e=>A.search())},{default:d((()=>l[36]||(l[36]=[u("查询")]))),_:1}),o(H,{type:"default",title:"重置查询条件",onClick:l[9]||(l[9]=e=>A.refresh())},{default:d((()=>l[37]||(l[37]=[u("重置")]))),_:1}),o(H,{type:"primary",onClick:l[10]||(l[10]=e=>A.add())},{default:d((()=>l[38]||(l[38]=[u("添加")]))),_:1})])),_:1})])),_:1}),o(B,null,{default:d((()=>[o(R,null,{default:d((()=>[o(H,{title:"删除",onClick:l[11]||(l[11]=e=>A.selectOpen("dele"))},{default:d((()=>l[39]||(l[39]=[u("删除")]))),_:1}),o(H,{title:"是否禁用",onClick:l[12]||(l[12]=e=>A.selectOpen("disable"))},{default:d((()=>l[40]||(l[40]=[u("禁用")]))),_:1})])),_:1})])),_:1}),o(L,{modelValue:$.selectDialog,"onUpdate:modelValue":l[15]||(l[15]=e=>$.selectDialog=e),title:$.selectTitle,"close-on-click-modal":!1,"close-on-press-escape":!1,top:"20vh"},{footer:d((()=>[o(H,{onClick:A.selectCancel},{default:d((()=>l[41]||(l[41]=[u("取消")]))),_:1},8,["onClick"]),o(H,{type:"primary",onClick:A.selectSubmit},{default:d((()=>l[42]||(l[42]=[u("提交")]))),_:1},8,["onClick"])])),default:d((()=>[o(K,{ref:"selectRef","label-width":"120px"},{default:d((()=>["disable"===$.selectType?(t(),m(J,{key:0,label:"是否禁用"},{default:d((()=>[o(Q,{modelValue:$.is_disable,"onUpdate:modelValue":l[13]||(l[13]=e=>$.is_disable=e),"active-value":1,"inactive-value":0},null,8,["modelValue"])])),_:1})):"dele"===$.selectType?(t(),m(J,{key:1},{default:d((()=>[n("span",F,"确定要删除选中的"+p($.name)+"吗？",1)])),_:1})):c("",!0),o(J,{label:$.name+"ID"},{default:d((()=>[o(M,{modelValue:$.selectIds,"onUpdate:modelValue":l[14]||(l[14]=e=>$.selectIds=e),type:"textarea",autosize:"",disabled:""},null,8,["modelValue"])])),_:1},8,["label"])])),_:1},512)])),_:1},8,["modelValue","title"]),h((t(),m(Z,{ref:"table",data:$.data,height:$.height,onSortChange:A.sort,onSelectionChange:A.select},{default:d((()=>[o(N,{type:"selection",width:"42",title:"全选/反选"}),o(N,{prop:$.idkey,label:"ID",width:"80",sortable:"custom"},null,8,["prop"]),o(N,{prop:"member_id",label:"会员ID",width:"100",sortable:"custom"}),o(N,{prop:"member_nickname",label:"会员昵称","min-width":"135","show-overflow-tooltip":""}),o(N,{prop:"member_username",label:"会员用户名","min-width":"135","show-overflow-tooltip":""}),o(N,{prop:"headimgurl",label:"头像","min-width":"62"},{default:d((e=>[o(W,{"file-url":e.row.headimgurl,avatar:"",lazy:""},null,8,["file-url"])])),_:1}),o(N,{prop:"nickname",label:"昵称","min-width":"135","show-overflow-tooltip":""}),o(N,{prop:"platform_name",label:"平台","min-width":"80","show-overflow-tooltip":""}),o(N,{prop:"application_name",label:"应用","min-width":"120","show-overflow-tooltip":""}),o(N,{prop:"is_disable_name",label:"禁用","min-width":"85",sortable:"custom"}),o(N,{prop:"login_time",label:"登录时间",width:"165"}),o(N,{prop:"create_time",label:"添加/绑定时间","min-width":"165"}),o(N,{prop:"update_time",label:"修改时间","min-width":"165"}),o(N,{label:"操作",width:"95"},{default:d((e=>[o(X,{type:"primary",class:"mr-1",underline:!1,onClick:l=>A.edit(e.row)},{default:d((()=>l[43]||(l[43]=[u(" 修改 ")]))),_:2},1032,["onClick"]),o(X,{type:"primary",title:"解绑",underline:!1,onClick:l=>A.selectOpen("dele",[e.row])},{default:d((()=>l[44]||(l[44]=[u(" 删除 ")]))),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data","height","onSortChange","onSelectionChange"])),[[ae,$.loading]]),h(o(ee,{total:$.count,"onUpdate:total":l[16]||(l[16]=e=>$.count=e),page:$.query.page,"onUpdate:page":l[17]||(l[17]=e=>$.query.page=e),limit:$.query.limit,"onUpdate:limit":l[18]||(l[18]=e=>$.query.limit=e),onPagination:A.list},null,8,["total","page","limit","onPagination"]),[[f,$.count>0]]),o(L,{modelValue:$.dialog,"onUpdate:modelValue":l[35]||(l[35]=e=>$.dialog=e),title:$.dialogTitle,"close-on-click-modal":!1,"close-on-press-escape":!1,"before-close":A.cancel,top:"5vh"},{footer:d((()=>[o(H,{loading:$.loading,onClick:A.cancel},{default:d((()=>l[45]||(l[45]=[u("取消")]))),_:1},8,["loading","onClick"]),o(H,{loading:$.loading,type:"primary",onClick:A.submit},{default:d((()=>l[46]||(l[46]=[u("提交")]))),_:1},8,["loading","onClick"])])),default:d((()=>[o(le,{native:"",height:$.height-30},{default:d((()=>[o(K,{ref:"ref",rules:$.rules,model:$.model,"label-width":"100px"},{default:d((()=>[o(J,{label:"会员ID",prop:"member_id"},{default:d((()=>[o(M,{modelValue:$.model.member_id,"onUpdate:modelValue":l[19]||(l[19]=e=>$.model.member_id=e),type:"number",placeholder:"请输入会员ID",clearable:""},null,8,["modelValue"])])),_:1}),o(J,{label:"平台",prop:"platform"},{default:d((()=>[o(G,{modelValue:$.model.platform,"onUpdate:modelValue":l[20]||(l[20]=e=>$.model.platform=e)},{default:d((()=>[(t(!0),i(s,null,r($.platforms,(e=>(t(),m(P,{key:e.value,value:e.value,label:e.label},null,8,["value","label"])))),128))])),_:1},8,["modelValue"])])),_:1}),o(J,{label:"应用",prop:"application"},{default:d((()=>[o(G,{modelValue:$.model.application,"onUpdate:modelValue":l[21]||(l[21]=e=>$.model.application=e)},{default:d((()=>[(t(!0),i(s,null,r($.applications,(e=>(t(),m(P,{key:e.value,value:e.value,label:e.label},null,8,["value","label"])))),128))])),_:1},8,["modelValue"])])),_:1}),o(J,{label:"unionid",prop:"unionid"},{default:d((()=>[o(M,{modelValue:$.model.unionid,"onUpdate:modelValue":l[22]||(l[22]=e=>$.model.unionid=e),placeholder:"请输入unionid",clearable:""},null,8,["modelValue"])])),_:1}),o(J,{label:"openid",prop:"openid"},{default:d((()=>[o(M,{modelValue:$.model.openid,"onUpdate:modelValue":l[23]||(l[23]=e=>$.model.openid=e),placeholder:"请输入openid",clearable:""},null,8,["modelValue"])])),_:1}),o(J,{label:"头像",prop:"headimgurl"},{default:d((()=>[o(M,{modelValue:$.model.headimgurl,"onUpdate:modelValue":l[24]||(l[24]=e=>$.model.headimgurl=e),placeholder:"请输入头像链接或上传头像",clearable:""},null,8,["modelValue"])])),_:1}),o(J,{prop:"headimgurl"},{default:d((()=>[o(W,{"file-url":$.model.headimgurl,"onUpdate:fileUrl":l[25]||(l[25]=e=>$.model.headimgurl=e),"file-title":"上传头像",height:100,avatar:"",upload:""},null,8,["file-url"])])),_:1}),o(J,{label:"昵称",prop:"nickname"},{default:d((()=>[o(M,{modelValue:$.model.nickname,"onUpdate:modelValue":l[26]||(l[26]=e=>$.model.nickname=e),placeholder:"请输入昵称",clearable:""},null,8,["modelValue"])])),_:1}),o(J,{label:"备注",prop:"remark"},{default:d((()=>[o(M,{modelValue:$.model.remark,"onUpdate:modelValue":l[27]||(l[27]=e=>$.model.remark=e),placeholder:"请输入备注",clearable:""},null,8,["modelValue"])])),_:1}),$.model[$.idkey]?(t(),m(J,{key:0,label:"登录IP",prop:"login_ip"},{default:d((()=>[o(M,{modelValue:$.model.login_ip,"onUpdate:modelValue":l[28]||(l[28]=e=>$.model.login_ip=e),disabled:""},null,8,["modelValue"])])),_:1})):c("",!0),$.model[$.idkey]?(t(),m(J,{key:1,label:"登录地区",prop:"login_region"},{default:d((()=>[o(M,{modelValue:$.model.login_region,"onUpdate:modelValue":l[29]||(l[29]=e=>$.model.login_region=e),disabled:""},null,8,["modelValue"])])),_:1})):c("",!0),$.model[$.idkey]?(t(),m(J,{key:2,label:"登录时间",prop:"login_time"},{default:d((()=>[o(M,{modelValue:$.model.login_time,"onUpdate:modelValue":l[30]||(l[30]=e=>$.model.login_time=e),disabled:""},null,8,["modelValue"])])),_:1})):c("",!0),$.model[$.idkey]?(t(),m(J,{key:3,label:"登录次数",prop:"login_num"},{default:d((()=>[o(M,{modelValue:$.model.login_num,"onUpdate:modelValue":l[31]||(l[31]=e=>$.model.login_num=e),disabled:""},null,8,["modelValue"])])),_:1})):c("",!0),$.model[$.idkey]?(t(),m(J,{key:4,label:"添加/绑定时间",prop:"create_time"},{default:d((()=>[o(M,{modelValue:$.model.create_time,"onUpdate:modelValue":l[32]||(l[32]=e=>$.model.create_time=e),disabled:""},null,8,["modelValue"])])),_:1})):c("",!0),$.model[$.idkey]?(t(),m(J,{key:5,label:"修改时间",prop:"update_time"},{default:d((()=>[o(M,{modelValue:$.model.update_time,"onUpdate:modelValue":l[33]||(l[33]=e=>$.model.update_time=e),disabled:""},null,8,["modelValue"])])),_:1})):c("",!0),$.model.delete_time?(t(),m(J,{key:6,label:"删除时间",prop:"delete_time"},{default:d((()=>[o(M,{modelValue:$.model.delete_time,"onUpdate:modelValue":l[34]||(l[34]=e=>$.model.delete_time=e),disabled:""},null,8,["modelValue"])])),_:1})):c("",!0)])),_:1},8,["rules","model"])])),_:1},8,["height"])])),_:1},8,["modelValue","title","before-close"])])}]]);export{M as default};
