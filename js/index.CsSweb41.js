import{b as e,h as t,aR as o,aW as l,cP as a,d as n,a as r,aX as i,dg as u,dh as s,r as d,D as f,aH as c,K as p,o as m,G as v,bP as g,aD as h,V as y,c as w,e as b,k as _,f as x,n as C,g as $,ap as O,_ as E,s as j,cA as V,di as S,dj as P,dk as A,dl as F,dm as N,a7 as D,dn as B,dp as H,L as I,a4 as T,w as U,bU as k}from"./index.fjkLwUVu.js";import{E as z}from"./el-dialog.BQ-7T3N1.js";import{F as L}from"./index.CZvH84Pk.js";const M=e({zIndex:{type:t([Number,String]),default:100},target:{type:String,default:""},offset:{type:Number,default:0},position:{type:String,values:["top","bottom"],default:"top"}}),G={scroll:({scrollTop:e,fixed:t})=>o(e)&&l(t),[a]:e=>l(e)},J="ElAffix",K=n({name:J});const R=j(E(n({...K,props:M,emits:G,setup(e,{expose:t,emit:o}){const l=e,a=r("affix"),n=i(),E=i(),j=i(),{height:V}=u(),{height:S,width:P,top:A,bottom:F,update:N}=s(E,{windowScroll:!1}),D=s(n),B=d(!1),H=d(0),I=d(0),T=f((()=>({height:B.value?`${S.value}px`:"",width:B.value?`${P.value}px`:""}))),U=f((()=>{if(!B.value)return{};const e=l.offset?c(l.offset):0;return{height:`${S.value}px`,width:`${P.value}px`,top:"top"===l.position?e:"",bottom:"bottom"===l.position?e:"",transform:I.value?`translateY(${I.value}px)`:"",zIndex:l.zIndex}})),k=()=>{if(!j.value)return;H.value=j.value instanceof Window?document.documentElement.scrollTop:j.value.scrollTop||0;const{position:e,target:t,offset:o}=l,a=o+S.value;if("top"===e)if(t){const e=D.bottom.value-a;B.value=o>A.value&&D.bottom.value>0,I.value=e<0?e:0}else B.value=o>A.value;else if(t){const e=V.value-D.top.value-a;B.value=V.value-o<F.value&&V.value>D.top.value,I.value=e<0?-e:0}else B.value=V.value-o<F.value};return p(B,(e=>o("change",e))),m((()=>{var e;l.target?(n.value=null!=(e=document.querySelector(l.target))?e:void 0,n.value||v(J,`Target does not exist: ${l.target}`)):n.value=document.documentElement,j.value=g(E.value,!0),N()})),h(j,"scroll",(()=>{N(),o("scroll",{scrollTop:H.value,fixed:B.value})})),y(k),t({update:k,updateRoot:N}),(e,t)=>(w(),b("div",{ref_key:"root",ref:E,class:C($(a).b()),style:O($(T))},[_("div",{class:C({[$(a).m("fixed")]:B.value}),style:O($(U))},[x(e.$slots,"default")],6)],6))}}),[["__file","affix.vue"]]));var W=Object.defineProperty,q=Object.defineProperties,X=Object.getOwnPropertyDescriptors,Y=Object.getOwnPropertySymbols,Q=Object.prototype.hasOwnProperty,Z=Object.prototype.propertyIsEnumerable,ee=(e,t,o)=>t in e?W(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,te=(e,t)=>{for(var o in t||(t={}))Q.call(t,o)&&ee(e,o,t[o]);if(Y)for(var o of Y(t))Z.call(t,o)&&ee(e,o,t[o]);return e};function oe(e){let t=`请使用 '@${e}' 事件，不要放在 props 中`;return t+=`\nPlease use '@${e}' event instead of props`,t}var le=(e,t)=>{for(const[o,l]of t)e[o]=l;return e};const ae=n({props:{mode:{type:String,default:"default"},defaultContent:{type:Array,default:[]},defaultHtml:{type:String,default:""},defaultConfig:{type:Object,default:{}},modelValue:{type:String,default:""}},setup(e,t){const o=d(null),l=i(null),a=d("");return m((()=>{(()=>{if(!o.value)return;const n=V(e.defaultContent);var r,i;S({selector:o.value,mode:e.mode,content:n||[],html:e.defaultHtml||e.modelValue||"",config:(r=te({},e.defaultConfig),i={onCreated(o){if(l.value=o,t.emit("onCreated",o),e.defaultConfig.onCreated){const e=oe("onCreated");throw new Error(e)}},onChange(o){const l=o.getHtml();if(a.value=l,t.emit("update:modelValue",l),t.emit("onChange",o),e.defaultConfig.onChange){const e=oe("onChange");throw new Error(e)}},onDestroyed(o){if(t.emit("onDestroyed",o),e.defaultConfig.onDestroyed){const e=oe("onDestroyed");throw new Error(e)}},onMaxLength(o){if(t.emit("onMaxLength",o),e.defaultConfig.onMaxLength){const e=oe("onMaxLength");throw new Error(e)}},onFocus(o){if(t.emit("onFocus",o),e.defaultConfig.onFocus){const e=oe("onFocus");throw new Error(e)}},onBlur(o){if(t.emit("onBlur",o),e.defaultConfig.onBlur){const e=oe("onBlur");throw new Error(e)}},customAlert(o,l){if(t.emit("customAlert",o,l),e.defaultConfig.customAlert){const e=oe("customAlert");throw new Error(e)}},customPaste:(o,l)=>{if(e.defaultConfig.customPaste){const e=oe("customPaste");throw new Error(e)}let a;return t.emit("customPaste",o,l,(e=>{a=e})),a}},q(r,X(i)))})})()})),p((()=>e.modelValue),(e=>{e!==a.value&&function(e){const t=l.value;if(null==t)return;const o=t.isDisabled(),a=t.isFocused(),n=JSON.stringify(t.selection);if(t.enable(),t.focus(),t.select([]),t.deleteFragment(),P.setNodes(t,{type:"paragraph"},{mode:"highest"}),t.dangerouslyInsertHtml(e),!a)return t.deselect(),void t.blur();if(o)return t.deselect(),void t.disable();try{t.select(JSON.parse(n))}catch(r){t.select(A.start(t,[]))}}(e)})),{box:o}}}),ne={ref:"box",style:{height:"100%"}};var re=le(ae,[["render",function(e,t,o,l,a,n){return w(),b("div",ne,null,512)}]]);const ie=n({props:{editor:{type:Object},mode:{type:String,default:"default"},defaultConfig:{type:Object,default:{}}},setup(e){const t=d(null);return y((()=>{const{editor:o}=e;null!=o&&(o=>{if(t.value){if(null==o)throw new Error("Not found instance of Editor when create <Toolbar/> component");F.getToolbar(o)||N({editor:o,selector:t.value||"<div></div>",mode:e.mode,config:e.defaultConfig})}})(o)})),{selector:t}}}),ue={ref:"selector"};var se=le(ie,[["render",function(e,t,o,l,a,n){return w(),b("div",ue,null,512)}]]);const de={class:"editor-wrapper"},fe={__name:"index",props:{modelValue:{type:[String],default:""}},emits:["update:modelValue"],setup(e,{emit:t}){const o=e,l=D(),a=t;B("zh-cn"==l.language?"zh-CN":"en");const n=H(o,"modelValue",a),r=i(),u=d("default"),s=d({insertKeys:{index:24,keys:["uploadAttachment"]}}),f=d({placeholder:"请输入内容...",MENU_CONF:{uploadImage:{customBrowseAndUpload(){m.value=!0,g.value="image"}},uploadVideo:{customBrowseAndUpload(){m.value=!0,g.value="video"}},uploadAttachment:{customBrowseAndUpload(){m.value=!0,g.value="word"}}}}),c=e=>{r.value=e};function p(e){n.value=e.getHtml()}const m=d(!1),v=d("文件管理"),g=d("image");function h(){m.value=!1}function y(e){m.value=!1;var t="";const o=e.length;for(let l=0;l<o;l++)"image"===e[l].file_type?t+=`<img file-id="${e[l].file_id}" src="${e[l].file_url}" style="width:640px;"/>`:"video"===e[l].file_type?t+=`<div data-w-e-type="video" data-w-e-is-void><video width="640" height="480" controls>\n                <source file-id="${e[l].file_id}" src="${e[l].file_url}" type="video/mp4">\n                <object file-id="${e[l].file_id}" data="${e[l].file_url}">\n                  <embed file-id="${e[l].file_id}" src="${e[l].file_url}" width="640" height="480">\n                </object>\n              </video></div>`:"audio"===e[l].file_type?t+=`<div data-w-e-type="audio" data-w-e-is-void data-w-e-is-inline><audio controls>\n                <source file-id="${e[l].file_id}" src="${e[l].file_url}" type="audio/mp3">\n                <embed file-id="${e[l].file_id}" src="${e[l].file_url}">\n              </audio></div>`:t+=`<div data-w-e-type="attachment" data-w-e-is-void data-w-e-is-inline><a file-id="${e[l].file_id}" href="${e[l].file_url}" download="${e[l].file_url}" target="_blank">${e[l].file_name}.${e[l].file_ext}</a></div>`;r.value.dangerouslyInsertHtml(t)}return I((()=>{const e=r.value;null!=e&&e.destroy()})),(e,t)=>{const o=R,l=z;return w(),b("div",de,[T(o,{target:".editor-wrapper",offset:150},{default:U((()=>[T($(se),{id:"toolbar-container",editor:$(r),"default-config":$(s),mode:$(u)},null,8,["editor","default-config","mode"])])),_:1}),T($(re),{id:"editor-container",modelValue:$(n),"onUpdate:modelValue":t[0]||(t[0]=e=>k(n)?n.value=e:null),"default-config":$(f),mode:$(u),onOnChange:p,onOnCreated:c},null,8,["modelValue","default-config","mode"]),T(l,{modelValue:$(m),"onUpdate:modelValue":t[1]||(t[1]=e=>k(m)?m.value=e:null),title:$(v),"close-on-click-modal":!1,"close-on-press-escape":!1,top:"1vh",width:"80%","append-to-body":""},{default:U((()=>[T(L,{"file-type":$(g),onFileCancel:h,onFileSubmit:y},null,8,["file-type"])])),_:1},8,["modelValue","title"])])}}};export{fe as _};
